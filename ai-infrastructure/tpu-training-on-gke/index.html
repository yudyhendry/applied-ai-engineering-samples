
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This repository contains code samples and best practices from Google Cloud  Applied AI Engineering, focusing on building scalable and efficient AI systems on Google Cloud.">
      
      
        <meta name="author" content="Applied AI Engineering, Google Cloud">
      
      
        <link rel="canonical" href="https://googlecloudplatform.github.io/applied-ai-engineering-samples/ai-infrastructure/tpu-training-on-gke/">
      
      
        <link rel="prev" href="../terraform-modules/workload-identity/">
      
      
        <link rel="next" href="examples/">
      
      
      <link rel="icon" href="../../assets/aaie_favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>Overview - Google Cloud Applied AI Engineering</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775m1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25m13.274 9.537zl-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074M4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5M4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75M8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.5 4.5 0 0 1-.563-1.191 3.84 3.84 0 0 1-.05-2.063 4.65 4.65 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .75.75 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4 2.4 0 0 1-.507-.441 3.1 3.1 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19.01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.7 3.7 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.76 2.76 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6 6 0 0 0-.26.16 1 1 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1 1 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.61.61 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1 1 0 0 0-.34.398M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343za8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746m1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275M6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.75.75 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734L6.94 8 4.97 6.03a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005 0-.009.004"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.5 3.5 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327q0 .15-.025.292c.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5q-.002.615-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A5 5 0 0 1 8 16a5 5 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5 5 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.7 1.7 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06m.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.17.17 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.75.75 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5m4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5m0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5M2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../docs/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-6T56LKHEP0"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-6T56LKHEP0",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-6T56LKHEP0",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#running-tpu-training-workloads-on-gke" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Google Cloud Applied AI Engineering" class="md-header__button md-logo" aria-label="Google Cloud Applied AI Engineering" data-md-component="logo">
      
  <img src="../../assets/aaie_favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Google Cloud Applied AI Engineering
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GoogleCloudPlatform/applied-ai-engineering-samples" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GoogleCloudPlatform/applied-ai-engineering-samples
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../genai-on-vertex-ai/" class="md-tabs__link">
          
  
    
  
  GenAI on Vertex AI

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../research-operationalization/" class="md-tabs__link">
          
  
    
  
  Research Operationalization

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  AI Infrastructure

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Google Cloud Applied AI Engineering" class="md-nav__button md-logo" aria-label="Google Cloud Applied AI Engineering" data-md-component="logo">
      
  <img src="../../assets/aaie_favicon.png" alt="logo">

    </a>
    Google Cloud Applied AI Engineering
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GoogleCloudPlatform/applied-ai-engineering-samples" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GoogleCloudPlatform/applied-ai-engineering-samples
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../genai-on-vertex-ai/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    GenAI on Vertex AI
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../research-operationalization/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Research Operationalization
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    AI Infrastructure
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            AI Infrastructure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../terraform-modules/bootstrap/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Terraform Modules
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
          
        
      
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  <span class="md-ellipsis">
    TPU Training on GKE
  </span>
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            TPU Training on GKE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="examples/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Images
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#architecture-of-the-training-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture of the training environment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-workload-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Training workload processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-pre-requisites" class="md-nav__link">
    <span class="md-ellipsis">
      Configure pre-requisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configure pre-requisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-automation-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Configure automation settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-cloud-build-impersonating-rights" class="md-nav__link">
    <span class="md-ellipsis">
      Grant Cloud Build impersonating rights
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy" class="md-nav__link">
    <span class="md-ellipsis">
      Deploy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deploy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clone-the-github-repo" class="md-nav__link">
    <span class="md-ellipsis">
      Clone the GitHub repo.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-build-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Configure build parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configure build parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tpu-types" class="md-nav__link">
    <span class="md-ellipsis">
      TPU types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-workload-identity-and-kueue-configurations" class="md-nav__link">
    <span class="md-ellipsis">
      Modify Workload Identity and Kueue configurations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submit-the-build" class="md-nav__link">
    <span class="md-ellipsis">
      Submit the build
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-workloads-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Training workloads examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Cleanup Environment
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/GoogleCloudPlatform/applied-ai-engineering-samples/edit/master/docs/ai-infrastructure/tpu-training-on-gke/README.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/GoogleCloudPlatform/applied-ai-engineering-samples/raw/master/docs/ai-infrastructure/tpu-training-on-gke/README.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="running-tpu-training-workloads-on-gke">Running TPU training workloads on GKE<a class="headerlink" href="#running-tpu-training-workloads-on-gke" title="Permanent link">&para;</a></h1>
<p>This reference guide compiles best practices, prescriptive guidance, and code samples for running large-scale machine learning training workloads with <a href="https://cloud.google.com/tpu/docs/tpus-in-gke">TPU v4, TPU v5p, and TPU v5e on Google Kubernetes Engine (GKE)</a>.</p>
<p>The guide covers two main topics:
- <strong>Configuring a GKE based environment for large scale training on Cloud TPUs</strong>
  - This section describes how to configure a GKE cluster to optimize it for running large-scale machine learning training workloads on <a href="https://cloud.google.com/tpu">Cloud TPUs</a>.
- <strong>Defining, Submitting, and Monitoring Training Jobs</strong>
  - This section provides guidance on how to define, submit, and manage training jobs using the Kubernetes <a href="https://github.com/kubernetes-sigs/jobset">JobSet</a> and <a href="https://github.com/kubernetes-sigs/kueue">Kueue</a> APIs.</p>
<h2 id="architecture-of-the-training-environment">Architecture of the training environment<a class="headerlink" href="#architecture-of-the-training-environment" title="Permanent link">&para;</a></h2>
<p>The diagram below depicts a high-level architecture of the training environment.</p>
<p><img alt="arch" src="images/training-cluster.png" /></p>
<p>The foundation of the environment is a regional, VPC-native GKE cluster. The cluster has two types of node pools: 
- A single node pool with CPU-only nodes and 
- Several <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/tpus">TPU node pools</a></p>
<p>This cluster topology supports running both <a href="https://cloud.google.com/tpu/docs/multislice-introduction">single-slice and multislice TPU</a> training jobs.</p>
<p>Following are the components supporting the environment:</p>
<ul>
<li><a href="https://cloud.google.com/storage">Cloud Storage</a> buckets for saving training datasets and artifacts produced by training jobs (such as logs and checkpoints)</li>
<li><a href="https://cloud.google.com/artifact-registry">Cloud Artifact Registry</a> for packaging and managing the training, data processing, and other components of a training workload as Docker container images.</li>
<li><a href="https://cloud.google.com/vertex-ai/docs/experiments/tensorboard-introduction">Vertex AI TensorBoard</a> for tracking and visualizing training metrics.</li>
<li><a href="https://cloud.google.com/monitoring">Cloud Monitoring</a> for collecting and analyzing non-functional performance metrics</li>
<li><a href="https://cloud.google.com/logging">Cloud Logging</a> for managing logs produced by training workloads.</li>
<li>Training workloads <a href="https://cloud.google.com/iam/docs/service-account-impersonation">impersonate an Identity and Access Management (IAM) service accounts</a> to access Google Cloud services, such as Cloud Storage and Vertex AI TensorBoard.</li>
</ul>
<h2 id="training-workload-processing">Training workload processing<a class="headerlink" href="#training-workload-processing" title="Permanent link">&para;</a></h2>
<p>The following diagram illustrates the process of submitting and processing training workloads in the training environment.</p>
<p><img alt="training workloads" src="images/workload-processing.png" /></p>
<p>In this guide we advocate using the <a href="https://github.com/kubernetes-sigs/jobset">Kubernetes JobSet API</a> as the preferred method of coordinating large-scale distributed machine learning training workloads on Kubernetes. When combined with the <a href="https://github.com/kubernetes-sigs/kueue">Kubernetes Kueue</a> job queuing API, it provides flexible and comprehensive training job orchestration.</p>
<p>The training environment's <strong>Kueue</strong> configuration  consists of a single <a href="https://kueue.sigs.k8s.io/docs/concepts/cluster_queue/">ClusterQueue</a> and multiple <a href="https://kueue.sigs.k8s.io/docs/concepts/local_queue/">LocalQueues</a>. This topology provides basic multi-tenancy and supports managing and prioritizing jobs submitted by multiple teams.</p>
<p>All training workloads are represented as JobSet resources. A JobSet resource may contain multiple job types, such as a core distributed training job and an auxiliary job that manages TensorBoard logs and other artifacts generated by the training job.</p>
<p>JobSet workloads are submitted to a namespaced LocalQueue that points to a ClusterQueue. As illustrated in the diagram, in our reference implementation, there is a single cluster queue.</p>
<p>Kueue monitors when resources (such as TPU slices) required by a workload (JobSet) are available, and then decides when to admit the workload and how to allocate the workload's components to the cluster's node pools. </p>
<p>For example, a training workload can contain two types of jobs:
- A multislice distributed training job
- A job that uploads TensorBoard logs generated by the training job to Vertex AI TensorBoard</p>
<p>When all the resources required by this workload become available, the training job's workers are started on the requested number of TPU slices. The TensorBoard uploader is started on one of the nodes in the CPU node pool.</p>
<p>If the compute resources required by other submitted workloads are not available, these workloads are queued and scheduled for admission based on the priorities that have been defined in the Kueue configuration.</p>
<p>To submit a JobSet-defined workload, you need to create a YAML JobSet resource definition. There are a few different ways to do this. In this guide, we demonstrate two approaches:
- Using <a href="https://kustomize.io/">Kustomize</a>, which helps you create YAML JobSet resource definitions directly.
- Using  <a href="https://github.com/google/maxtext/tree/main/xpk">xpk</a>, which provides an easy-to-use Python-based CLI.</p>
<h2 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">&para;</a></h2>
<p>The deployment process is automated using <a href="https://cloud.google.com/build">Cloud Build</a>, <a href="https://cloud.google.com/docs/terraform">Terraform</a>, and <a href="https://kustomize.io/">Kustomize</a>. The Cloud Build configuration file  defines two deployment stages:</p>
<p>In the first stage a Terraform configuration is applied, which:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Creates a network, a subnet, and IP ranges for GKE pods and services.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Creates a VPC-native cluster.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Creates a node pool with nodes equipped with CPUs only.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Creates a specified number of TPU node pools.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Creates an IAM service account for Workload Identity and an IAM service account to be used as a custom node pool service account.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Configures the cluster for Workload Identity.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Creates a Google Cloud Storage bucket.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Creates a Vertex TensorBoard instance</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Creates an Artifact Registry</li>
</ul>
<p>In the second stage, the <a href="https://github.com/kubernetes-sigs/jobset">JobSet</a> and <a href="https://kueue.sigs.k8s.io/docs/concepts/cluster_queue/">Kueue</a> custom resources are installed and Kueue is configured as described in the previous section. </p>
<blockquote>
<p>[!WARNING]
 Your project must have sufficient <a href="https://cloud.google.com/tpu/docs/quota">quota to provision TPU resources</a>. Else, you can <a href="https://cloud.google.com/docs/quota/view-manage#requesting_higher_quota">request for a higher quota limit</a>.</p>
</blockquote>
<h3 id="configure-pre-requisites">Configure pre-requisites<a class="headerlink" href="#configure-pre-requisites" title="Permanent link">&para;</a></h3>
<p>Before submitting the Cloud Build build, you need to:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Create a new Google Cloud project or select an existing one.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Enable the necessary services.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Configure an automation service account and an automation Google Cloud storage bucket.</li>
</ul>
<p>The following services are required by the base environment:
- <code>cloudbuild.googleapis.com</code>
- <code>artifactregistry.googleapis.com</code>
- <code>cloudkms.googleapis.com</code>
- <code>cloudresourcemanager.googleapis.com</code>
- <code>container.googleapis.com</code>
- <code>compute.googleapis.com</code>
- <code>container.googleapis.com</code>
- <code>iam.googleapis.com</code>
- <code>iamcredentials.googleapis.com</code>
- <code>serviceusage.googleapis.com</code>
- <code>stackdriver.googleapis.com</code>
- <code>storage-component.googleapis.com</code>
- <code>storage.googleapis.com</code>
- <code>sts.googleapis.com</code>
- <code>aiplatform.googleapis.com</code></p>
<p>You also need a GCS bucket that will be used for managing Terraform state and other Terraform artifacts and a service account that will be impersonated by Terraform when provisioning the environment. The service account should have the following project level roles:
- <code>iam.securityAdmin</code>
- <code>iam.serviceAccountAdmin</code>
- <code>compute.networkAdmin</code>
- <code>container.admin</code>
- <code>iam.serviceAccountUser</code>
- <code>storage.admin</code>
- <code>artifactregistry.admin</code>
- <code>aiplatform.user</code>
- <code>serviceusage.serviceUsageConsumer</code></p>
<p>If you lack administrative-level permissions to enable GCP services or to create and configure service accounts in your project, your project administrator must perform these tasks. However, if you are a project owner, you can enable the services and create and configure the automation service account as part of the <a href="#configure-automation-settings">Configure automation settings</a> step.</p>
<h4 id="configure-automation-settings">Configure automation settings<a class="headerlink" href="#configure-automation-settings" title="Permanent link">&para;</a></h4>
<p>During this step, Terraform is configured to utilize the specified automation bucket and service account. Optionally, if configured, it can also enable the necessary services and create both the automation service account and the automation bucket.</p>
<ol>
<li>Clone this repo</li>
<li>Change the current folder to <a href="environment/0-bootstrap/">environment/0-bootstrap</a></li>
<li>Copy the <a href="environment/0-bootstrap/terraform.tfvars.tmpl">terraform.tfvars.tmpl</a> file to <code>terraform.tfvars</code></li>
<li>Modify the <code>terraform.tfvars</code> file to reflect your environment</li>
<li><code>project_id</code> - your project ID</li>
<li><code>deletion_protection</code> - Set to <code>true</code> to protect you cluster and GCS buckets from accidental deletion by Terraform apply/destroy commands. Unless this field is set to false, a terraform destroy or terraform apply that would delete the cluster or non-empty GCS buckets will fail.</li>
<li><code>create_automation_bucket</code> - set to <code>true</code> if you want to create a new automation bucket; set to <code>false</code> if you want to use an existing bucket</li>
<li><code>automation_bucket</code> - the name and location of a bucket you want to use for automation. If you use an existing bucket the <code>location</code> field will be ignored</li>
<li><code>create_automation_sa</code> - set to <code>true</code> if you want to create a new automation service account; set to <code>false</code> if you want to use an existing service account</li>
<li><code>automation_sa_name</code> - the name of an automation service account to be used by Terraform for impersonation</li>
<li><code>enable_apis</code> - set to <code>true</code> if you want to enable the services listed in the <code>services</code> variable</li>
<li><code>services</code> - the list of services to enable in your project</li>
<li><code>roles</code> - the list of roles to assign to an automation services account. These roles will only be assigned to a newly created account. If you are using an existing account, this list will be ignored.</li>
<li>Execute the <code>terraform init</code> command</li>
<li>Execute the <code>terraform apply</code> command</li>
</ol>
<p>The Terraform configuration generates prepopulated template files for configuring the Terraform backend and providers, which can be utilized in the following setup stages. These template files are stored in the <code>gs://&lt;YOUR-AUTOMATION-BUCKET/providers</code> and <code>gs://&lt;YOUR-AUTOMATION-BUCKET/tfvars</code> folders. </p>
<h4 id="grant-cloud-build-impersonating-rights">Grant Cloud Build impersonating rights<a class="headerlink" href="#grant-cloud-build-impersonating-rights" title="Permanent link">&para;</a></h4>
<p>To be able to impersonate the automation service account, the Cloud Build service account needs to have the <code>iam.serviceAccountTokenCreator</code> rights on the automation service account.</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nv">AUTOMATION_SERVICE_ACCOUNT</span><span class="o">=</span>&lt;AUTOMATTION_SERVICE_ACOUNT_EMAIL&gt;
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nv">CLOUD_BUILD_SERVICE_ACCOUNT</span><span class="o">=</span>&lt;PROJECT_NUMBER&gt;@cloudbuild.gserviceaccount.com
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>gcloud<span class="w"> </span>iam<span class="w"> </span>service-accounts<span class="w"> </span>add-iam-policy-binding<span class="w"> </span><span class="nv">$AUTOMATION_SERVICE_ACCOUNT</span><span class="w"> </span>--member<span class="o">=</span><span class="s2">&quot;serviceAccount:</span><span class="nv">$CLOUD_BUILD_SERVICE_ACCOUNT</span><span class="s2">&quot;</span><span class="w"> </span>--role<span class="o">=</span><span class="s1">&#39;roles/iam.serviceAccountTokenCreator&#39;</span>
</span></code></pre></div>
<p>Replace <PROJECT_NUMBER> with your project number. Replace <AUTOMATION_SERVICE_ACCOUNT_EMAIL> with the email of your automation service account. If you created the automation service account using the bootstrap Terraform you can retrieve its email by executing the <code>terraform output automation_sa</code> command from the <code>environment\0-bootstrap</code> folder.</p>
<h3 id="deploy">Deploy<a class="headerlink" href="#deploy" title="Permanent link">&para;</a></h3>
<h4 id="clone-the-github-repo">Clone the GitHub repo.<a class="headerlink" href="#clone-the-github-repo" title="Permanent link">&para;</a></h4>
<p>If you haven't already run the bootstrap stage, please clone this repository now.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/GoogleCloudPlatform/applied-ai-engineering-samples.git
</span></code></pre></div>
<p>Change the current directory, to <code>ai-infrastructure/tpu-training-on-gke/environment</code>.</p>
<h4 id="configure-build-parameters">Configure build parameters<a class="headerlink" href="#configure-build-parameters" title="Permanent link">&para;</a></h4>
<p>To configure the Terraform steps in the build, copy the <a href="environment/1-base-infrastructure/terraform.tfvars.tmpl">terraform.tfvars.tmpl</a> template file in the <a href="environment/1-base-infrastructure/">1-base-infrastructure</a> folder to <code>terraform.tfvars</code>. Make modifications to the <code>terraform.tfvars</code> file to align it with your specific environment. At the very least, you should set the following variables:</p>
<ul>
<li><code>project_id</code> - your project ID</li>
<li><code>region</code> - your region for a VPC and a GKE cluster</li>
<li><code>prefix</code> - the prefix that will be added to the default names of resources provisioned by the configuration</li>
<li><code>tensorboard_config.region</code> - the region of a TensorBoard instance</li>
<li><code>create_artifact_registry</code> - set to <code>true</code> to create a new artifact registry</li>
<li><code>cpu_node_pools</code> - The <code>terraform.tfvars.tmpl</code> template provides an example configuration for a single autoscaling node pool.  </li>
<li><code>tpu_node_pools</code> - The  template shows an example configuration for two TPU node pools: one with a single v5e-4 pod slice and the other with a single v5e-16 pod slice. Modify the <code>tpu_node_pools</code> variable to provision different TPU node pool configurations, as described below.</li>
</ul>
<p>If you wish to modify other default settings, such as the default name suffixes for a cluster or GCS bucket names, you can override the defaults specified in the <a href="environment/1-base-infrastructure/variables.tf">variables.tf</a> file within your <code>terraform.tfvars</code> file.</p>
<p>When configuring TPU node pools, ensure that you set the TPU type to one of the following values:</p>
<h5 id="tpu-types">TPU types<a class="headerlink" href="#tpu-types" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>TPU type name</th>
<th>Slice type</th>
<th>Slice topology</th>
<th>TPU VM type</th>
<th>Number of VMs in a slice</th>
<th>Number of chips in a VM</th>
</tr>
</thead>
<tbody>
<tr>
<td>v5litepod-4</td>
<td>tpu-v5-lite-podslice</td>
<td>2x2</td>
<td>ct5lp-hightpu-4t</td>
<td>1</td>
<td>4</td>
</tr>
<tr>
<td>v5litepod-16</td>
<td>tpu-v5-lite-podslice</td>
<td>4x4</td>
<td>ct5lp-hightpu-4t</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>v5litepod-32</td>
<td>tpu-v5-lite-podslice</td>
<td>4x8</td>
<td>ct5lp-hightpu-4t</td>
<td>8</td>
<td>4</td>
</tr>
<tr>
<td>v5litepod-64</td>
<td>tpu-v5-lite-podslice</td>
<td>8x8</td>
<td>ct5lp-hightpu-4t</td>
<td>16</td>
<td>4</td>
</tr>
<tr>
<td>v5litepod-128</td>
<td>tpu-v5-lite-podslice</td>
<td>8x16</td>
<td>ct5lp-hightpu-4t</td>
<td>32</td>
<td>4</td>
</tr>
<tr>
<td>v5litepod-256</td>
<td>tpu-v5-lite-podslice</td>
<td>16x16</td>
<td>ct5lp-hightpu-4t</td>
<td>64</td>
<td>4</td>
</tr>
<tr>
<td>v4-8</td>
<td>tpu-v4-podslice</td>
<td>2x2x1</td>
<td>ct4p-hightpu-4t</td>
<td>1</td>
<td>4</td>
</tr>
<tr>
<td>v4-16</td>
<td>tpu-v4-podslice</td>
<td>2x2x2</td>
<td>ct4p-hightpu-4t</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>v4-32</td>
<td>tpu-v4-podslice</td>
<td>2x2x4</td>
<td>ct4p-hightpu-4t</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>v4-64</td>
<td>tpu-v4-podslice</td>
<td>2x4x4</td>
<td>ct4p-hightpu-4t</td>
<td>8</td>
<td>4</td>
</tr>
<tr>
<td>v4-128</td>
<td>tpu-v4-podslice</td>
<td>4x4x4</td>
<td>ct4p-hightpu-4t</td>
<td>16</td>
<td>4</td>
</tr>
<tr>
<td>v4-256</td>
<td>tpu-v4-podslice</td>
<td>4x4x8</td>
<td>ct4p-hightpu-4t</td>
<td>32</td>
<td>4</td>
</tr>
<tr>
<td>v4-512</td>
<td>tpu-v4-podslice</td>
<td>4x8x8</td>
<td>ct4p-hightpu-4t</td>
<td>64</td>
<td>4</td>
</tr>
<tr>
<td>v4-1024</td>
<td>tpu-v4-podslice</td>
<td>8x8x8</td>
<td>ct4p-hightpu-4t</td>
<td>128</td>
<td>4</td>
</tr>
<tr>
<td>v4-1536</td>
<td>tpu-v4-podslice</td>
<td>8x8x12</td>
<td>ct4p-hightpu-4t</td>
<td>192</td>
<td>4</td>
</tr>
<tr>
<td>v4-2048</td>
<td>tpu-v4-podslice</td>
<td>8x8x16</td>
<td>ct4p-hightpu-4t</td>
<td>256</td>
<td>4</td>
</tr>
<tr>
<td>v4-4096</td>
<td>tpu-v4-podslice</td>
<td>8x16x16</td>
<td>ct4p-hightpu-4t</td>
<td>512</td>
<td>4</td>
</tr>
<tr>
<td>v5p-8</td>
<td>tpu-v5p-slice</td>
<td>2x2x1</td>
<td>ct5p-hightpu-4t</td>
<td>1</td>
<td>4</td>
</tr>
<tr>
<td>v5p-16</td>
<td>tpu-v5p-slice</td>
<td>2x2x2</td>
<td>ct5p-hightpu-4t</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>v5p-32</td>
<td>tpu-v5p-slice</td>
<td>2x2x4</td>
<td>ct5p-hightpu-4t</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>v5p-64</td>
<td>tpu-v5p-slice</td>
<td>2x4x4</td>
<td>ct5p-hightpu-4t</td>
<td>8</td>
<td>4</td>
</tr>
<tr>
<td>v5p-128</td>
<td>tpu-v5p-slice</td>
<td>4x4x4</td>
<td>ct5p-hightpu-4t</td>
<td>16</td>
<td>4</td>
</tr>
<tr>
<td>v5p-256</td>
<td>tpu-v5p-slice</td>
<td>4x4x8</td>
<td>ct5p-hightpu-4t</td>
<td>32</td>
<td>4</td>
</tr>
<tr>
<td>v5p-384</td>
<td>tpu-v5p-slice</td>
<td>4x4x12</td>
<td>ct5p-hightpu-4t</td>
<td>48</td>
<td>4</td>
</tr>
<tr>
<td>v5p-512</td>
<td>tpu-v5p-slice</td>
<td>4x8x8</td>
<td>ct5p-hightpu-4t</td>
<td>64</td>
<td>4</td>
</tr>
<tr>
<td>v5p-640</td>
<td>tpu-v5p-slice</td>
<td>4x4x20</td>
<td>ct5p-hightpu-4t</td>
<td>80</td>
<td>4</td>
</tr>
<tr>
<td>v5p-768</td>
<td>tpu-v5p-slice</td>
<td>4x8x12</td>
<td>ct5p-hightpu-4t</td>
<td>96</td>
<td>4</td>
</tr>
<tr>
<td>v5p-896</td>
<td>tpu-v5p-slice</td>
<td>4x4x28</td>
<td>ct5p-hightpu-4t</td>
<td>112</td>
<td>4</td>
</tr>
<tr>
<td>v5p-1024</td>
<td>tpu-v5p-slice</td>
<td>8x8x8</td>
<td>ct5p-hightpu-4t</td>
<td>128</td>
<td>4</td>
</tr>
<tr>
<td>v5p-1152</td>
<td>tpu-v5p-slice</td>
<td>4x12x12</td>
<td>ct5p-hightpu-4t</td>
<td>144</td>
<td>4</td>
</tr>
<tr>
<td>v5p-1280</td>
<td>tpu-v5p-slice</td>
<td>4x8x20</td>
<td>ct5p-hightpu-4t</td>
<td>160</td>
<td>4</td>
</tr>
<tr>
<td>v5p-1408</td>
<td>tpu-v5p-slice</td>
<td>4x4x44</td>
<td>ct5p-hightpu-4t</td>
<td>176</td>
<td>4</td>
</tr>
<tr>
<td>v5p-1536</td>
<td>tpu-v5p-slice</td>
<td>8x8x12</td>
<td>ct5p-hightpu-4t</td>
<td>192</td>
<td>4</td>
</tr>
<tr>
<td>v5p-1664</td>
<td>tpu-v5p-slice</td>
<td>4x4x52</td>
<td>ct5p-hightpu-4t</td>
<td>208</td>
<td>4</td>
</tr>
<tr>
<td>v5p-1792</td>
<td>tpu-v5p-slice</td>
<td>4x8x28</td>
<td>ct5p-hightpu-4t</td>
<td>224</td>
<td>4</td>
</tr>
<tr>
<td>v5p-1920</td>
<td>tpu-v5p-slice</td>
<td>4x12x20</td>
<td>ct5p-hightpu-4t</td>
<td>240</td>
<td>4</td>
</tr>
<tr>
<td>v5p-2048</td>
<td>tpu-v5p-slice</td>
<td>8x8x16</td>
<td>ct5p-hightpu-4t</td>
<td>256</td>
<td>4</td>
</tr>
<tr>
<td>v5p-2176</td>
<td>tpu-v5p-slice</td>
<td>4x4x68</td>
<td>ct5p-hightpu-4t</td>
<td>272</td>
<td>4</td>
</tr>
<tr>
<td>v5p-2304</td>
<td>tpu-v5p-slice</td>
<td>8x12x12</td>
<td>ct5p-hightpu-4t</td>
<td>288</td>
<td>4</td>
</tr>
<tr>
<td>v5p-2432</td>
<td>tpu-v5p-slice</td>
<td>4x4x76</td>
<td>ct5p-hightpu-4t</td>
<td>304</td>
<td>4</td>
</tr>
<tr>
<td>v5p-2560</td>
<td>tpu-v5p-slice</td>
<td>8x8x20</td>
<td>ct5p-hightpu-4t</td>
<td>320</td>
<td>4</td>
</tr>
<tr>
<td>v5p-2688</td>
<td>tpu-v5p-slice</td>
<td>4x12x28</td>
<td>ct5p-hightpu-4t</td>
<td>336</td>
<td>4</td>
</tr>
<tr>
<td>v5p-2816</td>
<td>tpu-v5p-slice</td>
<td>4x8x44</td>
<td>ct5p-hightpu-4t</td>
<td>352</td>
<td>4</td>
</tr>
<tr>
<td>v5p-2944</td>
<td>tpu-v5p-slice</td>
<td>4x4x92</td>
<td>ct5p-hightpu-4t</td>
<td>368</td>
<td>4</td>
</tr>
<tr>
<td>v5p-3072</td>
<td>tpu-v5p-slice</td>
<td>4x12x16</td>
<td>ct5p-hightpu-4t</td>
<td>384</td>
<td>4</td>
</tr>
<tr>
<td>v5p-3200</td>
<td>tpu-v5p-slice</td>
<td>4x20x20</td>
<td>ct5p-hightpu-4t</td>
<td>400</td>
<td>4</td>
</tr>
<tr>
<td>v5p-3328</td>
<td>tpu-v5p-slice</td>
<td>4x8x52</td>
<td>ct5p-hightpu-4t</td>
<td>416</td>
<td>4</td>
</tr>
<tr>
<td>v5p-3456</td>
<td>tpu-v5p-slice</td>
<td>12x12x12</td>
<td>ct5p-hightpu-4t</td>
<td>432</td>
<td>4</td>
</tr>
<tr>
<td>v5p-3584</td>
<td>tpu-v5p-slice</td>
<td>8x8x28</td>
<td>ct5p-hightpu-4t</td>
<td>448</td>
<td>4</td>
</tr>
<tr>
<td>v5p-3712</td>
<td>tpu-v5p-slice</td>
<td>4x4x116</td>
<td>ct5p-hightpu-4t</td>
<td>464</td>
<td>4</td>
</tr>
<tr>
<td>v5p-3840</td>
<td>tpu-v5p-slice</td>
<td>8x12x20</td>
<td>ct5p-hightpu-4t</td>
<td>480</td>
<td>4</td>
</tr>
<tr>
<td>v5p-3968</td>
<td>tpu-v5p-slice</td>
<td>4x4x124</td>
<td>ct5p-hightpu-4t</td>
<td>496</td>
<td>4</td>
</tr>
<tr>
<td>v5p-4096</td>
<td>tpu-v5p-slice</td>
<td>8x16x16</td>
<td>ct5p-hightpu-4t</td>
<td>512</td>
<td>4</td>
</tr>
<tr>
<td>v5p-4224</td>
<td>tpu-v5p-slice</td>
<td>4x12x44</td>
<td>ct5p-hightpu-4t</td>
<td>528</td>
<td>4</td>
</tr>
<tr>
<td>v5p-4352</td>
<td>tpu-v5p-slice</td>
<td>4x8x68</td>
<td>ct5p-hightpu-4t</td>
<td>544</td>
<td>4</td>
</tr>
<tr>
<td>v5p-4480</td>
<td>tpu-v5p-slice</td>
<td>4x20x28</td>
<td>ct5p-hightpu-4t</td>
<td>560</td>
<td>4</td>
</tr>
<tr>
<td>v5p-4608</td>
<td>tpu-v5p-slice</td>
<td>12x12x16</td>
<td>ct5p-hightpu-4t</td>
<td>576</td>
<td>4</td>
</tr>
<tr>
<td>v5p-4736</td>
<td>tpu-v5p-slice</td>
<td>4x4x148</td>
<td>ct5p-hightpu-4t</td>
<td>592</td>
<td>4</td>
</tr>
<tr>
<td>v5p-4864</td>
<td>tpu-v5p-slice</td>
<td>4x8x76</td>
<td>ct5p-hightpu-4t</td>
<td>608</td>
<td>4</td>
</tr>
<tr>
<td>v5p-4992</td>
<td>tpu-v5p-slice</td>
<td>4x12x52</td>
<td>ct5p-hightpu-4t</td>
<td>624</td>
<td>4</td>
</tr>
<tr>
<td>v5p-5120</td>
<td>tpu-v5p-slice</td>
<td>8x16x20</td>
<td>ct5p-hightpu-4t</td>
<td>640</td>
<td>4</td>
</tr>
<tr>
<td>v5p-5248</td>
<td>tpu-v5p-slice</td>
<td>4x4x164</td>
<td>ct5p-hightpu-4t</td>
<td>656</td>
<td>4</td>
</tr>
<tr>
<td>v5p-5376</td>
<td>tpu-v5p-slice</td>
<td>8x12x28</td>
<td>ct5p-hightpu-4t</td>
<td>672</td>
<td>4</td>
</tr>
<tr>
<td>v5p-5504</td>
<td>tpu-v5p-slice</td>
<td>4x4x172</td>
<td>ct5p-hightpu-4t</td>
<td>688</td>
<td>4</td>
</tr>
<tr>
<td>v5p-5632</td>
<td>tpu-v5p-slice</td>
<td>8x8x44</td>
<td>ct5p-hightpu-4t</td>
<td>704</td>
<td>4</td>
</tr>
<tr>
<td>v5p-5760</td>
<td>tpu-v5p-slice</td>
<td>12x12x20</td>
<td>ct5p-hightpu-4t</td>
<td>720</td>
<td>4</td>
</tr>
<tr>
<td>v5p-5888</td>
<td>tpu-v5p-slice</td>
<td>4x8x92</td>
<td>ct5p-hightpu-4t</td>
<td>736</td>
<td>4</td>
</tr>
<tr>
<td>v5p-6016</td>
<td>tpu-v5p-slice</td>
<td>4x4x188</td>
<td>ct5p-hightpu-4t</td>
<td>752</td>
<td>4</td>
</tr>
<tr>
<td>v5p-6144</td>
<td>tpu-v5p-slice</td>
<td>12x16x16</td>
<td>ct5p-hightpu-4t</td>
<td>768</td>
<td>4</td>
</tr>
<tr>
<td>v5p-6272</td>
<td>tpu-v5p-slice</td>
<td>4x28x28</td>
<td>ct5p-hightpu-4t</td>
<td>784</td>
<td>4</td>
</tr>
<tr>
<td>v5p-6400</td>
<td>tpu-v5p-slice</td>
<td>8x20x20</td>
<td>ct5p-hightpu-4t</td>
<td>800</td>
<td>4</td>
</tr>
<tr>
<td>v5p-6528</td>
<td>tpu-v5p-slice</td>
<td>4x12x68</td>
<td>ct5p-hightpu-4t</td>
<td>816</td>
<td>4</td>
</tr>
<tr>
<td>v5p-6656</td>
<td>tpu-v5p-slice</td>
<td>8x8x52</td>
<td>ct5p-hightpu-4t</td>
<td>832</td>
<td>4</td>
</tr>
<tr>
<td>v5p-6784</td>
<td>tpu-v5p-slice</td>
<td>4x4x212</td>
<td>ct5p-hightpu-4t</td>
<td>848</td>
<td>4</td>
</tr>
<tr>
<td>v5p-6912</td>
<td>tpu-v5p-slice</td>
<td>12x12x24</td>
<td>ct5p-hightpu-4t</td>
<td>864</td>
<td>4</td>
</tr>
<tr>
<td>v5p-7040</td>
<td>tpu-v5p-slice</td>
<td>4x20x44</td>
<td>ct5p-hightpu-4t</td>
<td>880</td>
<td>4</td>
</tr>
<tr>
<td>v5p-7168</td>
<td>tpu-v5p-slice</td>
<td>8x16x28</td>
<td>ct5p-hightpu-4t</td>
<td>896</td>
<td>4</td>
</tr>
<tr>
<td>v5p-7296</td>
<td>tpu-v5p-slice</td>
<td>4x12x76</td>
<td>ct5p-hightpu-4t</td>
<td>912</td>
<td>4</td>
</tr>
<tr>
<td>v5p-7424</td>
<td>tpu-v5p-slice</td>
<td>4x8x116</td>
<td>ct5p-hightpu-4t</td>
<td>928</td>
<td>4</td>
</tr>
<tr>
<td>v5p-7552</td>
<td>tpu-v5p-slice</td>
<td>4x4x236</td>
<td>ct5p-hightpu-4t</td>
<td>944</td>
<td>4</td>
</tr>
<tr>
<td>v5p-7680</td>
<td>tpu-v5p-slice</td>
<td>12x16x20</td>
<td>ct5p-hightpu-4t</td>
<td>960</td>
<td>4</td>
</tr>
<tr>
<td>v5p-7808</td>
<td>tpu-v5p-slice</td>
<td>4x4x244</td>
<td>ct5p-hightpu-4t</td>
<td>976</td>
<td>4</td>
</tr>
<tr>
<td>v5p-7936</td>
<td>tpu-v5p-slice</td>
<td>4x8x124</td>
<td>ct5p-hightpu-4t</td>
<td>992</td>
<td>4</td>
</tr>
<tr>
<td>v5p-8064</td>
<td>tpu-v5p-slice</td>
<td>12x12x28</td>
<td>ct5p-hightpu-4t</td>
<td>1008</td>
<td>4</td>
</tr>
<tr>
<td>v5p-8192</td>
<td>tpu-v5p-slice</td>
<td>16x16x16</td>
<td>ct5p-hightpu-4t</td>
<td>1024</td>
<td>4</td>
</tr>
<tr>
<td>v5p-8320</td>
<td>tpu-v5p-slice</td>
<td>4x20x52</td>
<td>ct5p-hightpu-4t</td>
<td>1040</td>
<td>4</td>
</tr>
<tr>
<td>v5p-8448</td>
<td>tpu-v5p-slice</td>
<td>8x12x44</td>
<td>ct5p-hightpu-4t</td>
<td>1056</td>
<td>4</td>
</tr>
<tr>
<td>v5p-8704</td>
<td>tpu-v5p-slice</td>
<td>8x8x68</td>
<td>ct5p-hightpu-4t</td>
<td>1088</td>
<td>4</td>
</tr>
<tr>
<td>v5p-8832</td>
<td>tpu-v5p-slice</td>
<td>4x12x92</td>
<td>ct5p-hightpu-4t</td>
<td>1104</td>
<td>4</td>
</tr>
<tr>
<td>v5p-8960</td>
<td>tpu-v5p-slice</td>
<td>8x20x28</td>
<td>ct5p-hightpu-4t</td>
<td>1120</td>
<td>4</td>
</tr>
<tr>
<td>v5p-9216</td>
<td>tpu-v5p-slice</td>
<td>12x16x24</td>
<td>ct5p-hightpu-4t</td>
<td>1152</td>
<td>4</td>
</tr>
<tr>
<td>v5p-9472</td>
<td>tpu-v5p-slice</td>
<td>4x8x148</td>
<td>ct5p-hightpu-4t</td>
<td>1184</td>
<td>4</td>
</tr>
<tr>
<td>v5p-9600</td>
<td>tpu-v5p-slice</td>
<td>12x20x20</td>
<td>ct5p-hightpu-4t</td>
<td>1200</td>
<td>4</td>
</tr>
<tr>
<td>v5p-9728</td>
<td>tpu-v5p-slice</td>
<td>8x8x76</td>
<td>ct5p-hightpu-4t</td>
<td>1216</td>
<td>4</td>
</tr>
<tr>
<td>v5p-9856</td>
<td>tpu-v5p-slice</td>
<td>4x28x44</td>
<td>ct5p-hightpu-4t</td>
<td>1232</td>
<td>4</td>
</tr>
<tr>
<td>v5p-9984</td>
<td>tpu-v5p-slice</td>
<td>8x12x52</td>
<td>ct5p-hightpu-4t</td>
<td>1248</td>
<td>4</td>
</tr>
<tr>
<td>v5p-10240</td>
<td>tpu-v5p-slice</td>
<td>16x16x20</td>
<td>ct5p-hightpu-4t</td>
<td>1280</td>
<td>4</td>
</tr>
<tr>
<td>v5p-10368</td>
<td>tpu-v5p-slice</td>
<td>12x12x36</td>
<td>ct5p-hightpu-4t</td>
<td>1296</td>
<td>4</td>
</tr>
<tr>
<td>v5p-10496</td>
<td>tpu-v5p-slice</td>
<td>4x8x164</td>
<td>ct5p-hightpu-4t</td>
<td>1312</td>
<td>4</td>
</tr>
<tr>
<td>v5p-10752</td>
<td>tpu-v5p-slice</td>
<td>12x16x28</td>
<td>ct5p-hightpu-4t</td>
<td>1344</td>
<td>4</td>
</tr>
<tr>
<td>v5p-10880</td>
<td>tpu-v5p-slice</td>
<td>4x20x68</td>
<td>ct5p-hightpu-4t</td>
<td>1360</td>
<td>4</td>
</tr>
<tr>
<td>v5p-11008</td>
<td>tpu-v5p-slice</td>
<td>4x8x172</td>
<td>ct5p-hightpu-4t</td>
<td>1376</td>
<td>4</td>
</tr>
<tr>
<td>v5p-11136</td>
<td>tpu-v5p-slice</td>
<td>4x12x116</td>
<td>ct5p-hightpu-4t</td>
<td>1392</td>
<td>4</td>
</tr>
<tr>
<td>v5p-11264</td>
<td>tpu-v5p-slice</td>
<td>8x16x44</td>
<td>ct5p-hightpu-4t</td>
<td>1408</td>
<td>4</td>
</tr>
<tr>
<td>v5p-11520</td>
<td>tpu-v5p-slice</td>
<td>12x20x24</td>
<td>ct5p-hightpu-4t</td>
<td>1440</td>
<td>4</td>
</tr>
<tr>
<td>v5p-11648</td>
<td>tpu-v5p-slice</td>
<td>4x28x52</td>
<td>ct5p-hightpu-4t</td>
<td>1456</td>
<td>4</td>
</tr>
<tr>
<td>v5p-11776</td>
<td>tpu-v5p-slice</td>
<td>8x8x92</td>
<td>ct5p-hightpu-4t</td>
<td>1472</td>
<td>4</td>
</tr>
<tr>
<td>v5p-11904</td>
<td>tpu-v5p-slice</td>
<td>4x12x124</td>
<td>ct5p-hightpu-4t</td>
<td>1488</td>
<td>4</td>
</tr>
<tr>
<td>v5p-12032</td>
<td>tpu-v5p-slice</td>
<td>4x8x188</td>
<td>ct5p-hightpu-4t</td>
<td>1504</td>
<td>4</td>
</tr>
<tr>
<td>v5p-12160</td>
<td>tpu-v5p-slice</td>
<td>4x20x76</td>
<td>ct5p-hightpu-4t</td>
<td>1520</td>
<td>4</td>
</tr>
<tr>
<td>v5p-12288</td>
<td>tpu-v5p-slice</td>
<td>16x16x24</td>
<td>ct5p-hightpu-4t</td>
<td>1536</td>
<td>4</td>
</tr>
<tr>
<td>v5p-13824</td>
<td>tpu-v5p-slice</td>
<td>12x24x24</td>
<td>ct5p-hightpu-4t</td>
<td>1728</td>
<td>4</td>
</tr>
<tr>
<td>v5p-17920</td>
<td>tpu-v5p-slice</td>
<td>16x20x28</td>
<td>ct5p-hightpu-4t</td>
<td>2240</td>
<td>4</td>
</tr>
</tbody>
</table>
<h5 id="modify-workload-identity-and-kueue-configurations">Modify Workload Identity and Kueue configurations<a class="headerlink" href="#modify-workload-identity-and-kueue-configurations" title="Permanent link">&para;</a></h5>
<p>By default the following names and identifiers are used when configuring Workload Identity Federation and Kueue
- The IAM service account for WID - <code>&lt;prefix&gt;-wid-sa</code>
- The Kubernetes service account - <code>wid-ksa</code>
- The Cluster Queue name - <code>cluster-queue</code>
- The Local Queue name - <code>tpu-training-jobs</code>
- The Namespace for WID Kubernetes accoutn and Local Queue - <code>tpu-training</code></p>
<p>If you want to change these defaults, create a <code>terraform.tfvars</code> file in the <code>2-gke-config</code> and override the default values from the <a href="environment/2-gke-config/variables.tf">environment/2-gke-config/variables.tf</a> file.</p>
<h4 id="submit-the-build">Submit the build<a class="headerlink" href="#submit-the-build" title="Permanent link">&para;</a></h4>
<p>To initiate the build, execute the following command:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>export PROJECT_ID=&lt;PROJECT_ID&gt;
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>export AUTOMATION_BUCKET=&lt;YOUR_AUTOMATION_BUCKET&gt;
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>export AUTOMATION_ACCOUNT=&lt;YOUR_AUTOMATION_ACCOUNT&gt;
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>export ENV_NAME=&lt;ENV_STATE_FOLDER&gt; 
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>export JOBSET_API_VERSION=v0.3.0
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>export KUEUE_API_VERSION=v0.5.3 
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>gcloud builds submit \
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>  --project $PROJECT_ID \
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>  --config cloudbuild.provision.yaml \
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>  --substitutions _JOBSET_API_VERSION=$JOBSET_API_VERSION,_KUEUE_API_VERSION=$KUEUE_API_VERSION,_AUTOMATION_BUCKET=$AUTOMATION_BUCKET,_ENV_NAME=$ENV_NAME,_AUTOMATION_ACCOUNT=$AUTOMATION_ACCOUNT \
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>  --timeout &quot;2h&quot; \
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>  --machine-type=e2-highcpu-32 
</span></code></pre></div>
<p>Replace the following values:
- <code>&lt;PROJECT_ID&gt;</code> with your project ID
- <code>&lt;YOUR_AUTOMATION_BUCKET&gt;</code> with your automation bucket
- <code>&lt;YOUR_AUTOMATION_ACCOUNT&gt;</code> with you automation service account
- <code>&lt;ENV_STATE_FOLDER&gt;</code> with the name of the folder within your automation bucket where Terraform state and other artifacts will be managed</p>
<p>The examples in this repo have been tested with <code>v0.4.0</code> version of the JobSet API and <code>v0.5.3</code> version of the Kueue API.</p>
<p>To track the progress of the build, you can either follow the link displayed in Cloud Shell or visit the Cloud Build page on the <a href="https://console.cloud.google.com/cloud-build">Google Cloud Console</a>.</p>
<h2 id="training-workloads-examples">Training workloads examples<a class="headerlink" href="#training-workloads-examples" title="Permanent link">&para;</a></h2>
<p>The <a href="examples/"><code>examples</code></a> folder contains code samples that demonstrate how to configure, submit and manage a number of different training workloads.</p>
<blockquote>
<p>Refer to the <a href="examples/">README</a> in the <code>examples</code> folder for detailed instructions.</p>
</blockquote>
<h2 id="cleanup-environment">Cleanup Environment<a class="headerlink" href="#cleanup-environment" title="Permanent link">&para;</a></h2>
<p>To destroy the environment and clean up all the provisioned resources:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PROJECT_ID</span><span class="o">=</span>&lt;PROJECT_ID&gt;
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">AUTOMATION_BUCKET</span><span class="o">=</span>&lt;YOUR_AUTOMATION_BUCKET&gt;
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ENV_NAME</span><span class="o">=</span>&lt;TF_STATE_FOLDER&gt;
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>gcloud<span class="w"> </span>builds<span class="w"> </span>submit<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">  </span>--project<span class="w"> </span><span class="nv">$PROJECT_ID</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">  </span>--config<span class="w"> </span>cloudbuild.destroy.yaml<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">  </span>--substitutions<span class="w"> </span><span class="nv">_AUTOMATION_BUCKET</span><span class="o">=</span><span class="nv">$AUTOMATION_BUCKET</span>,_ENV_NAME<span class="o">=</span><span class="nv">$ENV_NAME</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">  </span>--timeout<span class="w"> </span><span class="s2">&quot;2h&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">  </span>--machine-type<span class="o">=</span>e2-highcpu-32<span class="w"> </span>
</span></code></pre></div>









  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! Help us improve this page by using our <a href="https://docs.google.com/forms/d/e/1FAIpQLSeHeph7Bf-BB8VOB63m3nDzo1_R_bM8zC_bwWfaTYrQAc0epQ/viewform?resourcekey=0-qNgLy5tTZZDA2jYDzFD9ag" target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../terraform-modules/workload-identity/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Workload Identity">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Workload Identity
              </div>
            </div>
          </a>
        
        
          
          <a href="examples/" class="md-footer__link md-footer__link--next" aria-label="Next: Overview">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Overview
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/GoogleCloudPlatform/applied-ai-engineering-samples" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://cloud.google.com/" target="_blank" rel="noopener" title="cloud.google.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>